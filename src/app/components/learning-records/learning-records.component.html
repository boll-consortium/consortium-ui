<app-inner-header [mainTitle]="mainTitle" [subTitle]="subTitle"></app-inner-header>
<div class="row">
  <div class="col-md-offset-0 col-md-8">
    <div class="box">
      <div class="box-header with-border">
        <div class="box-tools pull-right">
          <div class="has-feedback">
            <input type="text" [(ngModel)]="preSearchText" class="form-control input-sm" placeholder="Search Records">
            <span class="glyphicon glyphicon-search form-control-feedback" (click)="filterBySearchText()"></span>
          </div>
        </div>
        <!-- /.box-tools -->
      </div>
      <div class="box-body no-padding">
        <div class="alert alert-info" *ngIf="showMessage">{{message}}</div>
        <table class="table table-bordered table-striped">
          <tr>
            <th style="width: 7%">#</th>
            <th>School</th>
            <th>Record Type</th>
            <th>Contract Address</th>
            <th></th>
          </tr>
          <tbody *ngIf="rawInfos?.length > 0">
            <tr *ngFor="let rawInfo of rawInfos; let i = index;">
              <td>{{i+1}}</td>
              <td class="products-list product-list-in-box" [innerHTML]="getSchoolDetails(rawInfo.writer)"></td>
              <td>
                <a target="_blank" href="{{recordInfos[rawInfo.contractAddress].recordType}}"
                   *ngIf="recordInfos[rawInfo.contractAddress]" class="text-capitalize"
                   [innerHTML]="(recordInfos[rawInfo.contractAddress].recordType.split('/')[recordInfos[rawInfo.contractAddress].recordType.split('/').length - 1]) | highlight : searchText">
                </a>
              </td>
              <td [innerHTML]="rawInfo.contractAddress | highlight : searchText"></td>
              <td>
                <button type="button" class="btn btn-xs btn-default"  data-toggle="modal" attr.data-target="#modal-default{{i}}">Data</button>
                <button type="button" class="btn btn-xs bg-aqua"
                        [routerLink]="['/permissions', 'records', rawInfo.contractAddress]">View Permissions
                </button>
                <div class="modal fade" id="modal-default{{i}}">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Learning Log</h4>
                      </div>
                      <div class="modal-body" [innerHTML]="rawInfo.rawData?.innerHTML">
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Close</button>
                      </div>
                    </div>
                    <!-- /.modal-content -->
                  </div>
                  <!-- /.modal-dialog -->
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- /.box-body -->
      <div class="box-footer clearfix">
        <ul class="pagination pagination-sm no-margin pull-right">
          <ng-container *ngIf="rawInfos?.length > 0">
            <li><a style="disabled: {{(rawInfos.length/10) < 1}}" href="">&laquo;</a></li>
            <li *ngFor="let pageNumber of counter(1 + parseInt(rawInfos.length/10)); let i = index"><a
              routerLink="">{{i + 1}}</a>
            </li>
            <li><a style="disabled: {{(rawInfos.length/10) < 1}}" href="">&raquo;</a></li>
          </ng-container>
        </ul>
      </div>
    </div>
    <!-- /.box -->
  </div>
  <app-activity-logger></app-activity-logger>
</div>
